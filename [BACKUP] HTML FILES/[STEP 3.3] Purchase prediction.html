<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Preparing the data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="[STEP 3.3] Purchase prediction_files/libs/clipboard/clipboard.min.js"></script>
<script src="[STEP 3.3] Purchase prediction_files/libs/quarto-html/quarto.js"></script>
<script src="[STEP 3.3] Purchase prediction_files/libs/quarto-html/popper.min.js"></script>
<script src="[STEP 3.3] Purchase prediction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="[STEP 3.3] Purchase prediction_files/libs/quarto-html/anchor.min.js"></script>
<link href="[STEP 3.3] Purchase prediction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="[STEP 3.3] Purchase prediction_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="[STEP 3.3] Purchase prediction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="[STEP 3.3] Purchase prediction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="[STEP 3.3] Purchase prediction_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Preparing the data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flaml <span class="im">import</span> AutoML</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flaml.automl.data <span class="im">import</span> get_output_from_log</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dython.nominal <span class="im">import</span> associations</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mrmr <span class="im">import</span> mrmr_regression, mrmr_classif</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gaussian_kde</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>sklearn.set_config(transform_output<span class="op">=</span><span class="st">"pandas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>visits <span class="op">=</span> pd.read_csv(<span class="st">'Modified_Data/visits.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>id_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> visits.columns <span class="cf">if</span> <span class="st">'_id'</span> <span class="kw">in</span> col]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"We are dropping the following columns:"</span>, id_columns)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>visits.drop(columns<span class="op">=</span>id_columns, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We are dropping the following columns: ['visit_id', 'customer_id', 'transaction_id']</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop columns </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>visits.drop(columns<span class="op">=</span>[<span class="st">'start_timestamp'</span>, <span class="st">'end_timestamp'</span>, <span class="st">'user_first_name'</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'user_last_name'</span>, <span class="st">'email'</span>, <span class="st">'purchase_date'</span>, <span class="st">'purchase_price'</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'release_date'</span>, <span class="st">'month_year'</span>,<span class="st">'switch_type'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="null-values" class="level3">
<h3 class="anchored" data-anchor-id="null-values">Null values</h3>
<div id="cell-7" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>visits.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>visit_type                  0
visit_duration_time         0
gender                      0
email_domain             3787
platform               125546
user_review            398264
car_model              125546
fuel_type              125546
price                  125546
discount               125546
car_age_days           125546
purchased                   0
average_visit_time          0
visit_number                0
reviewed                    0
engaged                     0
loyalty                     0
dtype: int64</code></pre>
</div>
</div>
<p>For now we don’t care about those who didn’t bought at least a car, so we are going to drop the nans</p>
<div id="cell-9" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the column user_review</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>visits.drop(columns<span class="op">=</span>[<span class="st">'user_review'</span>, <span class="st">'visit_type'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the nans</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>visits.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> visits[<span class="st">'purchased'</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> visits.drop(columns<span class="op">=</span>[<span class="st">'purchased'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get dummies</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(X)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>X.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>(312983, 34)</code></pre>
</div>
</div>
</section>
<section id="analyse-the-features" class="level2">
<h2 class="anchored" data-anchor-id="analyse-the-features">Analyse the features</h2>
<div id="cell-14" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>associations <span class="op">=</span> associations(visits, multiprocessing<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'gnuplot'</span>, num_num_assoc<span class="op">=</span><span class="st">'spearman'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="%5BSTEP%203.3%5D%20Purchase%20prediction_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> mrmr_classif(X<span class="op">=</span>X, y<span class="op">=</span>y, K<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(selected_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 34/34 [00:22&lt;00:00,  1.48it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['engaged', 'reviewed', 'visit_number', 'visit_duration_time', 'loyalty', 'platform_Mobile App', 'average_visit_time', 'email_domain_gmail.com', 'platform_Dealership', 'gender_Other', 'car_model_Sedan', 'car_model_1 Series', 'discount', 'car_age_days', 'fuel_type_Diesel', 'email_domain_hotmail.com', 'gender_Male', 'fuel_type_Gasoline', 'price', 'car_model_Model M', 'car_model_Model i7', 'car_model_Model iX', 'car_model_Sierra', 'platform_Website', 'fuel_type_Electric', 'car_model_3 Series', 'car_model_Model i8', 'gender_Female', 'car_model_Touring', 'car_model_Model iY', 'email_domain_outlook.com', 'email_domain_yahoo.com', 'car_model_Coupe', 'car_model_Tourer']</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
</section>
<section id="train" class="level2">
<h2 class="anchored" data-anchor-id="train">Train</h2>
<div id="cell-17" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating the train and test set</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>automl <span class="op">=</span> AutoML()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>automl.fit(X_train, y_train, task<span class="op">=</span><span class="st">"classification"</span>, time_budget<span class="op">=</span><span class="dv">3600</span> , metric<span class="op">=</span><span class="st">"f1"</span>, log_file_name<span class="op">=</span><span class="st">"purchased.log"</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[flaml.automl.logger: 12-03 10:11:35] {1728} INFO - task = classification
[flaml.automl.logger: 12-03 10:11:35] {1739} INFO - Evaluation method: holdout
[flaml.automl.logger: 12-03 10:11:36] {1838} INFO - Minimizing error metric: 1-f1
[flaml.automl.logger: 12-03 10:11:36] {1955} INFO - List of ML learners in AutoML Run: ['lgbm', 'rf', 'xgboost', 'extra_tree', 'xgb_limitdepth', 'sgd', 'lrl1']
[flaml.automl.logger: 12-03 10:11:36] {2258} INFO - iteration 0, current learner lgbm
[flaml.automl.logger: 12-03 10:11:36] {2393} INFO - Estimated sufficient time budget=62703s. Estimated necessary time budget=1452s.
[flaml.automl.logger: 12-03 10:11:36] {2442} INFO -  at 4.4s,   estimator lgbm's best error=1.0000, best estimator lgbm's best error=1.0000
[flaml.automl.logger: 12-03 10:11:36] {2258} INFO - iteration 1, current learner lgbm
[flaml.automl.logger: 12-03 10:11:36] {2442} INFO -  at 4.6s,   estimator lgbm's best error=1.0000, best estimator lgbm's best error=1.0000
[flaml.automl.logger: 12-03 10:11:36] {2258} INFO - iteration 2, current learner lgbm
[flaml.automl.logger: 12-03 10:11:38] {2442} INFO -  at 6.7s,   estimator lgbm's best error=0.2981, best estimator lgbm's best error=0.2981
[flaml.automl.logger: 12-03 10:11:38] {2258} INFO - iteration 3, current learner sgd
[flaml.automl.logger: 12-03 10:11:38] {2442} INFO -  at 6.8s,   estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.2981
[flaml.automl.logger: 12-03 10:11:38] {2258} INFO - iteration 4, current learner lgbm
[flaml.automl.logger: 12-03 10:11:41] {2442} INFO -  at 9.5s,   estimator lgbm's best error=0.2066, best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:41] {2258} INFO - iteration 5, current learner sgd
[flaml.automl.logger: 12-03 10:11:41] {2442} INFO -  at 10.0s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:41] {2258} INFO - iteration 6, current learner xgboost
[flaml.automl.logger: 12-03 10:11:43] {2442} INFO -  at 11.4s,  estimator xgboost's best error=1.0000,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:43] {2258} INFO - iteration 7, current learner extra_tree
[flaml.automl.logger: 12-03 10:11:43] {2442} INFO -  at 11.6s,  estimator extra_tree's best error=1.0000,   best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:43] {2258} INFO - iteration 8, current learner xgboost
[flaml.automl.logger: 12-03 10:11:44] {2442} INFO -  at 12.2s,  estimator xgboost's best error=1.0000,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:44] {2258} INFO - iteration 9, current learner xgboost
[flaml.automl.logger: 12-03 10:11:45] {2442} INFO -  at 13.6s,  estimator xgboost's best error=0.3239,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:45] {2258} INFO - iteration 10, current learner xgboost
[flaml.automl.logger: 12-03 10:11:46] {2442} INFO -  at 14.3s,  estimator xgboost's best error=0.2431,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:46] {2258} INFO - iteration 11, current learner extra_tree
[flaml.automl.logger: 12-03 10:11:47] {2442} INFO -  at 15.2s,  estimator extra_tree's best error=0.7620,   best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:47] {2258} INFO - iteration 12, current learner rf
[flaml.automl.logger: 12-03 10:11:47] {2442} INFO -  at 15.6s,  estimator rf's best error=0.7692,   best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:47] {2258} INFO - iteration 13, current learner rf
[flaml.automl.logger: 12-03 10:11:48] {2442} INFO -  at 16.9s,  estimator rf's best error=0.5655,   best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:48] {2258} INFO - iteration 14, current learner xgboost
[flaml.automl.logger: 12-03 10:11:50] {2442} INFO -  at 18.3s,  estimator xgboost's best error=0.2431,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:50] {2258} INFO - iteration 15, current learner xgboost
[flaml.automl.logger: 12-03 10:11:51] {2442} INFO -  at 19.3s,  estimator xgboost's best error=0.2431,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:51] {2258} INFO - iteration 16, current learner sgd
[flaml.automl.logger: 12-03 10:11:51] {2442} INFO -  at 19.6s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:51] {2258} INFO - iteration 17, current learner lgbm
[flaml.automl.logger: 12-03 10:11:51] {2442} INFO -  at 19.8s,  estimator lgbm's best error=0.2066, best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:51] {2258} INFO - iteration 18, current learner sgd
[flaml.automl.logger: 12-03 10:11:52] {2442} INFO -  at 20.1s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.2066
[flaml.automl.logger: 12-03 10:11:52] {2258} INFO - iteration 19, current learner lgbm
[flaml.automl.logger: 12-03 10:11:53] {2442} INFO -  at 21.8s,  estimator lgbm's best error=0.1837, best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:53] {2258} INFO - iteration 20, current learner extra_tree
[flaml.automl.logger: 12-03 10:11:53] {2442} INFO -  at 22.0s,  estimator extra_tree's best error=0.7620,   best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:53] {2258} INFO - iteration 21, current learner rf
[flaml.automl.logger: 12-03 10:11:54] {2442} INFO -  at 22.3s,  estimator rf's best error=0.5655,   best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:54] {2258} INFO - iteration 22, current learner xgboost
[flaml.automl.logger: 12-03 10:11:55] {2442} INFO -  at 23.4s,  estimator xgboost's best error=0.1960,  best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:55] {2258} INFO - iteration 23, current learner lgbm
[flaml.automl.logger: 12-03 10:11:56] {2442} INFO -  at 24.1s,  estimator lgbm's best error=0.1837, best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:56] {2258} INFO - iteration 24, current learner lgbm
[flaml.automl.logger: 12-03 10:11:56] {2442} INFO -  at 25.0s,  estimator lgbm's best error=0.1837, best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:56] {2258} INFO - iteration 25, current learner sgd
[flaml.automl.logger: 12-03 10:11:57] {2442} INFO -  at 25.3s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:57] {2258} INFO - iteration 26, current learner sgd
[flaml.automl.logger: 12-03 10:11:57] {2442} INFO -  at 25.5s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1837
[flaml.automl.logger: 12-03 10:11:57] {2258} INFO - iteration 27, current learner lgbm
[flaml.automl.logger: 12-03 10:11:58] {2442} INFO -  at 26.4s,  estimator lgbm's best error=0.1755, best estimator lgbm's best error=0.1755
[flaml.automl.logger: 12-03 10:11:58] {2258} INFO - iteration 28, current learner extra_tree
[flaml.automl.logger: 12-03 10:11:58] {2442} INFO -  at 26.7s,  estimator extra_tree's best error=0.7620,   best estimator lgbm's best error=0.1755
[flaml.automl.logger: 12-03 10:11:58] {2258} INFO - iteration 29, current learner sgd
[flaml.automl.logger: 12-03 10:11:58] {2442} INFO -  at 26.9s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1755
[flaml.automl.logger: 12-03 10:11:58] {2258} INFO - iteration 30, current learner sgd
[flaml.automl.logger: 12-03 10:11:59] {2442} INFO -  at 27.6s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1755
[flaml.automl.logger: 12-03 10:11:59] {2258} INFO - iteration 31, current learner lgbm
[flaml.automl.logger: 12-03 10:11:59] {2442} INFO -  at 28.0s,  estimator lgbm's best error=0.1755, best estimator lgbm's best error=0.1755
[flaml.automl.logger: 12-03 10:11:59] {2258} INFO - iteration 32, current learner lgbm
[flaml.automl.logger: 12-03 10:12:07] {2442} INFO -  at 35.1s,  estimator lgbm's best error=0.1755, best estimator lgbm's best error=0.1755
[flaml.automl.logger: 12-03 10:12:07] {2258} INFO - iteration 33, current learner lgbm
[flaml.automl.logger: 12-03 10:12:09] {2442} INFO -  at 37.9s,  estimator lgbm's best error=0.1708, best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:09] {2258} INFO - iteration 34, current learner sgd
[flaml.automl.logger: 12-03 10:12:12] {2442} INFO -  at 40.1s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:12] {2258} INFO - iteration 35, current learner lgbm
[flaml.automl.logger: 12-03 10:12:17] {2442} INFO -  at 45.3s,  estimator lgbm's best error=0.1708, best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:17] {2258} INFO - iteration 36, current learner xgboost
[flaml.automl.logger: 12-03 10:12:18] {2442} INFO -  at 46.2s,  estimator xgboost's best error=0.1884,  best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:18] {2258} INFO - iteration 37, current learner sgd
[flaml.automl.logger: 12-03 10:12:19] {2442} INFO -  at 47.3s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:19] {2258} INFO - iteration 38, current learner xgboost
[flaml.automl.logger: 12-03 10:12:19] {2442} INFO -  at 47.5s,  estimator xgboost's best error=0.1884,  best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:19] {2258} INFO - iteration 39, current learner extra_tree
[flaml.automl.logger: 12-03 10:12:19] {2442} INFO -  at 47.7s,  estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:19] {2258} INFO - iteration 40, current learner xgboost
[flaml.automl.logger: 12-03 10:12:20] {2442} INFO -  at 48.1s,  estimator xgboost's best error=0.1832,  best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:20] {2258} INFO - iteration 41, current learner extra_tree
[flaml.automl.logger: 12-03 10:12:20] {2442} INFO -  at 48.2s,  estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:20] {2258} INFO - iteration 42, current learner extra_tree
[flaml.automl.logger: 12-03 10:12:20] {2442} INFO -  at 48.4s,  estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:20] {2258} INFO - iteration 43, current learner lgbm
[flaml.automl.logger: 12-03 10:12:21] {2442} INFO -  at 49.3s,  estimator lgbm's best error=0.1708, best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:21] {2258} INFO - iteration 44, current learner extra_tree
[flaml.automl.logger: 12-03 10:12:21] {2442} INFO -  at 49.6s,  estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:21] {2258} INFO - iteration 45, current learner sgd
[flaml.automl.logger: 12-03 10:12:23] {2442} INFO -  at 51.2s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:23] {2258} INFO - iteration 46, current learner extra_tree
[flaml.automl.logger: 12-03 10:12:23] {2442} INFO -  at 51.6s,  estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:23] {2258} INFO - iteration 47, current learner rf
[flaml.automl.logger: 12-03 10:12:23] {2442} INFO -  at 51.8s,  estimator rf's best error=0.5655,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:23] {2258} INFO - iteration 48, current learner extra_tree
[flaml.automl.logger: 12-03 10:12:24] {2442} INFO -  at 52.5s,  estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1708
[flaml.automl.logger: 12-03 10:12:24] {2258} INFO - iteration 49, current learner lgbm
[flaml.automl.logger: 12-03 10:12:26] {2442} INFO -  at 55.0s,  estimator lgbm's best error=0.1697, best estimator lgbm's best error=0.1697
[flaml.automl.logger: 12-03 10:12:26] {2258} INFO - iteration 50, current learner xgboost
[flaml.automl.logger: 12-03 10:12:28] {2442} INFO -  at 56.1s,  estimator xgboost's best error=0.1832,  best estimator lgbm's best error=0.1697
[flaml.automl.logger: 12-03 10:12:28] {2258} INFO - iteration 51, current learner sgd
[flaml.automl.logger: 12-03 10:12:34] {2442} INFO -  at 62.4s,  estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1697
[flaml.automl.logger: 12-03 10:12:34] {2258} INFO - iteration 52, current learner rf
[flaml.automl.logger: 12-03 10:12:34] {2442} INFO -  at 62.6s,  estimator rf's best error=0.3424,   best estimator lgbm's best error=0.1697
[flaml.automl.logger: 12-03 10:12:34] {2258} INFO - iteration 53, current learner rf
[flaml.automl.logger: 12-03 10:12:35] {2442} INFO -  at 63.3s,  estimator rf's best error=0.3395,   best estimator lgbm's best error=0.1697
[flaml.automl.logger: 12-03 10:12:35] {2258} INFO - iteration 54, current learner lgbm
[flaml.automl.logger: 12-03 10:12:37] {2442} INFO -  at 65.6s,  estimator lgbm's best error=0.1683, best estimator lgbm's best error=0.1683
[flaml.automl.logger: 12-03 10:12:37] {2258} INFO - iteration 55, current learner lgbm
[flaml.automl.logger: 12-03 10:17:56] {2442} INFO -  at 384.1s, estimator lgbm's best error=0.1683, best estimator lgbm's best error=0.1683
[flaml.automl.logger: 12-03 10:17:56] {2258} INFO - iteration 56, current learner extra_tree
[flaml.automl.logger: 12-03 10:17:59] {2442} INFO -  at 388.0s, estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1683
[flaml.automl.logger: 12-03 10:17:59] {2258} INFO - iteration 57, current learner lgbm
[flaml.automl.logger: 12-03 10:22:08] {2442} INFO -  at 636.9s, estimator lgbm's best error=0.1582, best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:08] {2258} INFO - iteration 58, current learner xgboost
[flaml.automl.logger: 12-03 10:22:12] {2442} INFO -  at 640.3s, estimator xgboost's best error=0.1814,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:12] {2258} INFO - iteration 59, current learner extra_tree
[flaml.automl.logger: 12-03 10:22:14] {2442} INFO -  at 643.0s, estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:14] {2258} INFO - iteration 60, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:22:35] {2442} INFO -  at 663.6s, estimator xgb_limitdepth's best error=0.1863,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:35] {2258} INFO - iteration 61, current learner rf
[flaml.automl.logger: 12-03 10:22:37] {2442} INFO -  at 665.9s, estimator rf's best error=0.3395,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:37] {2258} INFO - iteration 62, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:22:50] {2442} INFO -  at 678.7s, estimator xgb_limitdepth's best error=0.1863,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:50] {2258} INFO - iteration 63, current learner extra_tree
[flaml.automl.logger: 12-03 10:22:52] {2442} INFO -  at 680.5s, estimator extra_tree's best error=0.5137,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:22:52] {2258} INFO - iteration 64, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:23:11] {2442} INFO -  at 699.3s, estimator xgb_limitdepth's best error=0.1863,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:11] {2258} INFO - iteration 65, current learner sgd
[flaml.automl.logger: 12-03 10:23:18] {2442} INFO -  at 706.8s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:18] {2258} INFO - iteration 66, current learner xgboost
[flaml.automl.logger: 12-03 10:23:25] {2442} INFO -  at 713.5s, estimator xgboost's best error=0.1805,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:25] {2258} INFO - iteration 67, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:23:26] {2442} INFO -  at 714.5s, estimator xgb_limitdepth's best error=0.1863,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:26] {2258} INFO - iteration 68, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:23:28] {2442} INFO -  at 716.4s, estimator xgb_limitdepth's best error=0.1863,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:28] {2258} INFO - iteration 69, current learner extra_tree
[flaml.automl.logger: 12-03 10:23:31] {2442} INFO -  at 719.4s, estimator extra_tree's best error=0.2923,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:31] {2258} INFO - iteration 70, current learner xgboost
[flaml.automl.logger: 12-03 10:23:34] {2442} INFO -  at 722.3s, estimator xgboost's best error=0.1805,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:34] {2258} INFO - iteration 71, current learner extra_tree
[flaml.automl.logger: 12-03 10:23:37] {2442} INFO -  at 725.7s, estimator extra_tree's best error=0.2923,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:37] {2258} INFO - iteration 72, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:23:40] {2442} INFO -  at 728.5s, estimator xgb_limitdepth's best error=0.1863,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:23:40] {2258} INFO - iteration 73, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:24:20] {2442} INFO -  at 768.1s, estimator xgb_limitdepth's best error=0.1830,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:20] {2258} INFO - iteration 74, current learner sgd
[flaml.automl.logger: 12-03 10:24:22] {2442} INFO -  at 770.4s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:22] {2258} INFO - iteration 75, current learner extra_tree
[flaml.automl.logger: 12-03 10:24:27] {2442} INFO -  at 775.3s, estimator extra_tree's best error=0.2923,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:27] {2258} INFO - iteration 76, current learner sgd
[flaml.automl.logger: 12-03 10:24:29] {2442} INFO -  at 777.6s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:29] {2258} INFO - iteration 77, current learner extra_tree
[flaml.automl.logger: 12-03 10:24:33] {2442} INFO -  at 781.6s, estimator extra_tree's best error=0.2923,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:33] {2258} INFO - iteration 78, current learner extra_tree
[flaml.automl.logger: 12-03 10:24:35] {2442} INFO -  at 783.9s, estimator extra_tree's best error=0.2923,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:35] {2258} INFO - iteration 79, current learner sgd
[flaml.automl.logger: 12-03 10:24:37] {2442} INFO -  at 785.9s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:37] {2258} INFO - iteration 80, current learner extra_tree
[flaml.automl.logger: 12-03 10:24:40] {2442} INFO -  at 788.5s, estimator extra_tree's best error=0.2923,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:40] {2258} INFO - iteration 81, current learner extra_tree
[flaml.automl.logger: 12-03 10:24:45] {2442} INFO -  at 793.8s, estimator extra_tree's best error=0.2821,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:45] {2258} INFO - iteration 82, current learner lrl1
[flaml.automl.logger: 12-03 10:24:48] {2442} INFO -  at 796.2s, estimator lrl1's best error=0.9659, best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:48] {2258} INFO - iteration 83, current learner lrl1
[flaml.automl.logger: 12-03 10:24:50] {2442} INFO -  at 798.2s, estimator lrl1's best error=0.9659, best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:50] {2258} INFO - iteration 84, current learner lrl1
[flaml.automl.logger: 12-03 10:24:52] {2442} INFO -  at 800.4s, estimator lrl1's best error=0.9659, best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:52] {2258} INFO - iteration 85, current learner lrl1
[flaml.automl.logger: 12-03 10:24:59] {2442} INFO -  at 807.9s, estimator lrl1's best error=0.9428, best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:24:59] {2258} INFO - iteration 86, current learner sgd
[flaml.automl.logger: 12-03 10:25:04] {2442} INFO -  at 812.7s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:04] {2258} INFO - iteration 87, current learner sgd
[flaml.automl.logger: 12-03 10:25:16] {2442} INFO -  at 824.6s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:16] {2258} INFO - iteration 88, current learner sgd
[flaml.automl.logger: 12-03 10:25:20] {2442} INFO -  at 828.3s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:20] {2258} INFO - iteration 89, current learner sgd
[flaml.automl.logger: 12-03 10:25:26] {2442} INFO -  at 834.8s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:26] {2258} INFO - iteration 90, current learner extra_tree
[flaml.automl.logger: 12-03 10:25:34] {2442} INFO -  at 842.1s, estimator extra_tree's best error=0.2373,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:34] {2258} INFO - iteration 91, current learner extra_tree
[flaml.automl.logger: 12-03 10:25:40] {2442} INFO -  at 848.6s, estimator extra_tree's best error=0.2373,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:40] {2258} INFO - iteration 92, current learner sgd
[flaml.automl.logger: 12-03 10:25:42] {2442} INFO -  at 850.8s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:42] {2258} INFO - iteration 93, current learner extra_tree
[flaml.automl.logger: 12-03 10:25:51] {2442} INFO -  at 859.7s, estimator extra_tree's best error=0.2373,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:25:51] {2258} INFO - iteration 94, current learner lrl1
[flaml.automl.logger: 12-03 10:26:00] {2442} INFO -  at 868.7s, estimator lrl1's best error=0.9428, best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:00] {2258} INFO - iteration 95, current learner sgd
[flaml.automl.logger: 12-03 10:26:02] {2442} INFO -  at 871.0s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:02] {2258} INFO - iteration 96, current learner extra_tree
[flaml.automl.logger: 12-03 10:26:11] {2442} INFO -  at 879.1s, estimator extra_tree's best error=0.2373,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:11] {2258} INFO - iteration 97, current learner rf
[flaml.automl.logger: 12-03 10:26:14] {2442} INFO -  at 882.5s, estimator rf's best error=0.2901,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:14] {2258} INFO - iteration 98, current learner sgd
[flaml.automl.logger: 12-03 10:26:22] {2442} INFO -  at 890.1s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:22] {2258} INFO - iteration 99, current learner rf
[flaml.automl.logger: 12-03 10:26:26] {2442} INFO -  at 894.2s, estimator rf's best error=0.2901,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:26] {2258} INFO - iteration 100, current learner extra_tree
[flaml.automl.logger: 12-03 10:26:35] {2442} INFO -  at 903.2s, estimator extra_tree's best error=0.2373,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:35] {2258} INFO - iteration 101, current learner rf
[flaml.automl.logger: 12-03 10:26:39] {2442} INFO -  at 907.2s, estimator rf's best error=0.2901,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:39] {2258} INFO - iteration 102, current learner rf
[flaml.automl.logger: 12-03 10:26:40] {2442} INFO -  at 908.5s, estimator rf's best error=0.2521,   best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:40] {2258} INFO - iteration 103, current learner sgd
[flaml.automl.logger: 12-03 10:26:43] {2442} INFO -  at 911.5s, estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:26:43] {2258} INFO - iteration 104, current learner xgboost
[flaml.automl.logger: 12-03 10:27:39] {2442} INFO -  at 967.9s, estimator xgboost's best error=0.1793,  best estimator lgbm's best error=0.1582
[flaml.automl.logger: 12-03 10:27:39] {2258} INFO - iteration 105, current learner lgbm
[flaml.automl.logger: 12-03 10:28:20] {2442} INFO -  at 1009.0s,    estimator lgbm's best error=0.1514, best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:20] {2258} INFO - iteration 106, current learner rf
[flaml.automl.logger: 12-03 10:28:21] {2442} INFO -  at 1009.2s,    estimator rf's best error=0.2521,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:21] {2258} INFO - iteration 107, current learner lgbm
[flaml.automl.logger: 12-03 10:28:23] {2442} INFO -  at 1011.8s,    estimator lgbm's best error=0.1514, best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:23] {2258} INFO - iteration 108, current learner rf
[flaml.automl.logger: 12-03 10:28:24] {2442} INFO -  at 1012.3s,    estimator rf's best error=0.2356,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:24] {2258} INFO - iteration 109, current learner rf
[flaml.automl.logger: 12-03 10:28:24] {2442} INFO -  at 1012.8s,    estimator rf's best error=0.2035,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:24] {2258} INFO - iteration 110, current learner rf
[flaml.automl.logger: 12-03 10:28:25] {2442} INFO -  at 1013.2s,    estimator rf's best error=0.2035,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:25] {2258} INFO - iteration 111, current learner rf
[flaml.automl.logger: 12-03 10:28:25] {2442} INFO -  at 1013.6s,    estimator rf's best error=0.1923,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:25] {2258} INFO - iteration 112, current learner rf
[flaml.automl.logger: 12-03 10:28:25] {2442} INFO -  at 1013.9s,    estimator rf's best error=0.1923,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:25] {2258} INFO - iteration 113, current learner lgbm
[flaml.automl.logger: 12-03 10:28:28] {2442} INFO -  at 1016.1s,    estimator lgbm's best error=0.1514, best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:28] {2258} INFO - iteration 114, current learner extra_tree
[flaml.automl.logger: 12-03 10:28:31] {2442} INFO -  at 1019.6s,    estimator extra_tree's best error=0.2366,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:31] {2258} INFO - iteration 115, current learner rf
[flaml.automl.logger: 12-03 10:28:31] {2442} INFO -  at 1019.8s,    estimator rf's best error=0.1923,   best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:31] {2258} INFO - iteration 116, current learner lrl1
[flaml.automl.logger: 12-03 10:28:36] {2442} INFO -  at 1024.4s,    estimator lrl1's best error=0.9428, best estimator lgbm's best error=0.1514
[flaml.automl.logger: 12-03 10:28:36] {2258} INFO - iteration 117, current learner lgbm
[flaml.automl.logger: 12-03 10:29:34] {2442} INFO -  at 1082.2s,    estimator lgbm's best error=0.1422, best estimator lgbm's best error=0.1422
[flaml.automl.logger: 12-03 10:29:34] {2258} INFO - iteration 118, current learner lgbm
[flaml.automl.logger: 12-03 10:30:55] {2442} INFO -  at 1163.9s,    estimator lgbm's best error=0.1415, best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:30:55] {2258} INFO - iteration 119, current learner sgd
[flaml.automl.logger: 12-03 10:30:57] {2442} INFO -  at 1165.5s,    estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:30:57] {2258} INFO - iteration 120, current learner rf
[flaml.automl.logger: 12-03 10:30:59] {2442} INFO -  at 1167.8s,    estimator rf's best error=0.1865,   best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:30:59] {2258} INFO - iteration 121, current learner lgbm
[flaml.automl.logger: 12-03 10:31:24] {2442} INFO -  at 1192.3s,    estimator lgbm's best error=0.1415, best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:31:24] {2258} INFO - iteration 122, current learner rf
[flaml.automl.logger: 12-03 10:31:24] {2442} INFO -  at 1192.7s,    estimator rf's best error=0.1820,   best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:31:24] {2258} INFO - iteration 123, current learner rf
[flaml.automl.logger: 12-03 10:31:24] {2442} INFO -  at 1193.0s,    estimator rf's best error=0.1820,   best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:31:24] {2258} INFO - iteration 124, current learner sgd
[flaml.automl.logger: 12-03 10:31:26] {2442} INFO -  at 1194.4s,    estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:31:26] {2258} INFO - iteration 125, current learner rf
[flaml.automl.logger: 12-03 10:31:27] {2442} INFO -  at 1195.1s,    estimator rf's best error=0.1805,   best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:31:27] {2258} INFO - iteration 126, current learner lgbm
[flaml.automl.logger: 12-03 10:31:50] {2442} INFO -  at 1218.4s,    estimator lgbm's best error=0.1415, best estimator lgbm's best error=0.1415
[flaml.automl.logger: 12-03 10:31:50] {2258} INFO - iteration 127, current learner lgbm
[flaml.automl.logger: 12-03 10:32:31] {2442} INFO -  at 1259.6s,    estimator lgbm's best error=0.1382, best estimator lgbm's best error=0.1382
[flaml.automl.logger: 12-03 10:32:31] {2258} INFO - iteration 128, current learner lgbm
[flaml.automl.logger: 12-03 10:34:10] {2442} INFO -  at 1358.4s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:34:10] {2258} INFO - iteration 129, current learner lgbm
[flaml.automl.logger: 12-03 10:34:25] {2442} INFO -  at 1373.3s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:34:25] {2258} INFO - iteration 130, current learner lgbm
[flaml.automl.logger: 12-03 10:38:02] {2442} INFO -  at 1590.7s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:02] {2258} INFO - iteration 131, current learner sgd
[flaml.automl.logger: 12-03 10:38:03] {2442} INFO -  at 1591.4s,    estimator sgd's best error=1.0000,  best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:03] {2258} INFO - iteration 132, current learner rf
[flaml.automl.logger: 12-03 10:38:03] {2442} INFO -  at 1591.7s,    estimator rf's best error=0.1805,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:03] {2258} INFO - iteration 133, current learner rf
[flaml.automl.logger: 12-03 10:38:04] {2442} INFO -  at 1592.1s,    estimator rf's best error=0.1753,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:04] {2258} INFO - iteration 134, current learner rf
[flaml.automl.logger: 12-03 10:38:04] {2442} INFO -  at 1592.4s,    estimator rf's best error=0.1753,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:04] {2258} INFO - iteration 135, current learner rf
[flaml.automl.logger: 12-03 10:38:04] {2442} INFO -  at 1592.8s,    estimator rf's best error=0.1753,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:04] {2258} INFO - iteration 136, current learner rf
[flaml.automl.logger: 12-03 10:38:05] {2442} INFO -  at 1593.3s,    estimator rf's best error=0.1753,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:05] {2258} INFO - iteration 137, current learner rf
[flaml.automl.logger: 12-03 10:38:05] {2442} INFO -  at 1593.8s,    estimator rf's best error=0.1753,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:05] {2258} INFO - iteration 138, current learner sgd
[flaml.automl.logger: 12-03 10:38:08] {2442} INFO -  at 1596.6s,    estimator sgd's best error=0.9983,  best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:08] {2258} INFO - iteration 139, current learner rf
[flaml.automl.logger: 12-03 10:38:09] {2442} INFO -  at 1598.0s,    estimator rf's best error=0.1655,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:09] {2258} INFO - iteration 140, current learner lgbm
[flaml.automl.logger: 12-03 10:38:13] {2442} INFO -  at 1601.5s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:13] {2258} INFO - iteration 141, current learner rf
[flaml.automl.logger: 12-03 10:38:15] {2442} INFO -  at 1603.1s,    estimator rf's best error=0.1655,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:15] {2258} INFO - iteration 142, current learner rf
[flaml.automl.logger: 12-03 10:38:16] {2442} INFO -  at 1604.4s,    estimator rf's best error=0.1655,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:16] {2258} INFO - iteration 143, current learner rf
[flaml.automl.logger: 12-03 10:38:19] {2442} INFO -  at 1607.5s,    estimator rf's best error=0.1650,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:19] {2258} INFO - iteration 144, current learner lgbm
[flaml.automl.logger: 12-03 10:38:23] {2442} INFO -  at 1611.9s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:23] {2258} INFO - iteration 145, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 10:38:24] {2442} INFO -  at 1612.3s,    estimator xgb_limitdepth's best error=0.1830,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:24] {2258} INFO - iteration 146, current learner rf
[flaml.automl.logger: 12-03 10:38:26] {2442} INFO -  at 1614.1s,    estimator rf's best error=0.1642,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:26] {2258} INFO - iteration 147, current learner rf
[flaml.automl.logger: 12-03 10:38:27] {2442} INFO -  at 1615.6s,    estimator rf's best error=0.1642,   best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:38:27] {2258} INFO - iteration 148, current learner lgbm
[flaml.automl.logger: 12-03 10:41:06] {2442} INFO -  at 1774.4s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:41:06] {2258} INFO - iteration 149, current learner lgbm
[flaml.automl.logger: 12-03 10:41:20] {2442} INFO -  at 1788.4s,    estimator lgbm's best error=0.1315, best estimator lgbm's best error=0.1315
[flaml.automl.logger: 12-03 10:41:20] {2258} INFO - iteration 150, current learner lgbm
[flaml.automl.logger: 12-03 10:41:37] {2442} INFO -  at 1805.9s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:41:37] {2258} INFO - iteration 151, current learner lgbm
[flaml.automl.logger: 12-03 10:42:14] {2442} INFO -  at 1842.8s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:42:14] {2258} INFO - iteration 152, current learner lgbm
[flaml.automl.logger: 12-03 10:42:34] {2442} INFO -  at 1862.7s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:42:34] {2258} INFO - iteration 153, current learner lgbm
[flaml.automl.logger: 12-03 10:45:15] {2442} INFO -  at 2023.5s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:45:15] {2258} INFO - iteration 154, current learner rf
[flaml.automl.logger: 12-03 10:45:17] {2442} INFO -  at 2025.7s,    estimator rf's best error=0.1642,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:45:17] {2258} INFO - iteration 155, current learner rf
[flaml.automl.logger: 12-03 10:45:22] {2442} INFO -  at 2030.5s,    estimator rf's best error=0.1642,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:45:22] {2258} INFO - iteration 156, current learner lgbm
[flaml.automl.logger: 12-03 10:45:26] {2442} INFO -  at 2034.9s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:45:26] {2258} INFO - iteration 157, current learner lgbm
[flaml.automl.logger: 12-03 10:46:11] {2442} INFO -  at 2080.0s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:46:11] {2258} INFO - iteration 158, current learner lrl1
[flaml.automl.logger: 12-03 10:46:38] {2442} INFO -  at 2106.2s,    estimator lrl1's best error=0.9428, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:46:38] {2258} INFO - iteration 159, current learner rf
[flaml.automl.logger: 12-03 10:46:54] {2442} INFO -  at 2122.9s,    estimator rf's best error=0.1574,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:46:54] {2258} INFO - iteration 160, current learner lgbm
[flaml.automl.logger: 12-03 10:47:01] {2442} INFO -  at 2129.6s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:47:01] {2258} INFO - iteration 161, current learner lgbm
[flaml.automl.logger: 12-03 10:49:43] {2442} INFO -  at 2292.0s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:49:43] {2258} INFO - iteration 162, current learner rf
[flaml.automl.logger: 12-03 10:49:54] {2442} INFO -  at 2302.3s,    estimator rf's best error=0.1574,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:49:54] {2258} INFO - iteration 163, current learner lgbm
[flaml.automl.logger: 12-03 10:49:59] {2442} INFO -  at 2307.4s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:49:59] {2258} INFO - iteration 164, current learner rf
[flaml.automl.logger: 12-03 10:50:25] {2442} INFO -  at 2333.6s,    estimator rf's best error=0.1574,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:50:25] {2258} INFO - iteration 165, current learner lrl1
[flaml.automl.logger: 12-03 10:50:51] {2442} INFO -  at 2359.7s,    estimator lrl1's best error=0.9428, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:50:51] {2258} INFO - iteration 166, current learner xgboost
[flaml.automl.logger: 12-03 10:50:52] {2442} INFO -  at 2360.1s,    estimator xgboost's best error=0.1793,  best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:50:52] {2258} INFO - iteration 167, current learner lgbm
[flaml.automl.logger: 12-03 10:50:58] {2442} INFO -  at 2366.9s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:50:58] {2258} INFO - iteration 168, current learner rf
[flaml.automl.logger: 12-03 10:51:34] {2442} INFO -  at 2402.9s,    estimator rf's best error=0.1549,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:51:34] {2258} INFO - iteration 169, current learner rf
[flaml.automl.logger: 12-03 10:51:51] {2442} INFO -  at 2419.7s,    estimator rf's best error=0.1549,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:51:51] {2258} INFO - iteration 170, current learner extra_tree
[flaml.automl.logger: 12-03 10:51:55] {2442} INFO -  at 2423.9s,    estimator extra_tree's best error=0.2366,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:51:55] {2258} INFO - iteration 171, current learner lgbm
[flaml.automl.logger: 12-03 10:54:18] {2442} INFO -  at 2566.6s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:54:18] {2258} INFO - iteration 172, current learner lgbm
[flaml.automl.logger: 12-03 10:55:44] {2442} INFO -  at 2652.3s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:55:44] {2258} INFO - iteration 173, current learner lgbm
[flaml.automl.logger: 12-03 10:55:52] {2442} INFO -  at 2661.0s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:55:52] {2258} INFO - iteration 174, current learner lgbm
[flaml.automl.logger: 12-03 10:55:55] {2442} INFO -  at 2663.4s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:55:55] {2258} INFO - iteration 175, current learner rf
[flaml.automl.logger: 12-03 10:56:18] {2442} INFO -  at 2686.5s,    estimator rf's best error=0.1549,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:56:18] {2258} INFO - iteration 176, current learner rf
[flaml.automl.logger: 12-03 10:56:48] {2442} INFO -  at 2716.1s,    estimator rf's best error=0.1524,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 10:56:48] {2258} INFO - iteration 177, current learner lgbm
[flaml.automl.logger: 12-03 11:00:15] {2442} INFO -  at 2923.2s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:00:15] {2258} INFO - iteration 178, current learner lrl1
[flaml.automl.logger: 12-03 11:00:51] {2442} INFO -  at 2959.7s,    estimator lrl1's best error=0.9428, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:00:51] {2258} INFO - iteration 179, current learner rf
[flaml.automl.logger: 12-03 11:02:02] {2442} INFO -  at 3030.7s,    estimator rf's best error=0.1524,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:02] {2258} INFO - iteration 180, current learner lgbm
[flaml.automl.logger: 12-03 11:02:05] {2442} INFO -  at 3033.6s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:05] {2258} INFO - iteration 181, current learner rf
[flaml.automl.logger: 12-03 11:02:19] {2442} INFO -  at 3048.0s,    estimator rf's best error=0.1524,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:19] {2258} INFO - iteration 182, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:24] {2442} INFO -  at 3052.3s,    estimator extra_tree's best error=0.2071,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:24] {2258} INFO - iteration 183, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:27] {2442} INFO -  at 3055.4s,    estimator extra_tree's best error=0.2071,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:27] {2258} INFO - iteration 184, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:29] {2442} INFO -  at 3058.0s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:29] {2258} INFO - iteration 185, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:33] {2442} INFO -  at 3061.2s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:33] {2258} INFO - iteration 186, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:35] {2442} INFO -  at 3063.6s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:35] {2258} INFO - iteration 187, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:39] {2442} INFO -  at 3068.0s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:39] {2258} INFO - iteration 188, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:41] {2442} INFO -  at 3069.9s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:41] {2258} INFO - iteration 189, current learner extra_tree
[flaml.automl.logger: 12-03 11:02:44] {2442} INFO -  at 3072.3s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:02:44] {2258} INFO - iteration 190, current learner rf
[flaml.automl.logger: 12-03 11:03:10] {2442} INFO -  at 3098.8s,    estimator rf's best error=0.1524,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:10] {2258} INFO - iteration 191, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:13] {2442} INFO -  at 3102.0s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:13] {2258} INFO - iteration 192, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:20] {2442} INFO -  at 3108.6s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:20] {2258} INFO - iteration 193, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:23] {2442} INFO -  at 3111.2s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:23] {2258} INFO - iteration 194, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:25] {2442} INFO -  at 3113.1s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:25] {2258} INFO - iteration 195, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:30] {2442} INFO -  at 3118.6s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:30] {2258} INFO - iteration 196, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:38] {2442} INFO -  at 3126.3s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:38] {2258} INFO - iteration 197, current learner extra_tree
[flaml.automl.logger: 12-03 11:03:39] {2442} INFO -  at 3127.9s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:03:39] {2258} INFO - iteration 198, current learner lgbm
[flaml.automl.logger: 12-03 11:06:05] {2442} INFO -  at 3273.3s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:05] {2258} INFO - iteration 199, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:07] {2442} INFO -  at 3276.0s,    estimator extra_tree's best error=0.1776,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:07] {2258} INFO - iteration 200, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:12] {2442} INFO -  at 3280.2s,    estimator extra_tree's best error=0.1702,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:12] {2258} INFO - iteration 201, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:12] {2442} INFO -  at 3280.5s,    estimator xgb_limitdepth's best error=0.1791,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:12] {2258} INFO - iteration 202, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:12] {2442} INFO -  at 3280.7s,    estimator xgb_limitdepth's best error=0.1755,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:12] {2258} INFO - iteration 203, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:19] {2442} INFO -  at 3287.3s,    estimator extra_tree's best error=0.1673,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:19] {2258} INFO - iteration 204, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:19] {2442} INFO -  at 3287.5s,    estimator xgb_limitdepth's best error=0.1755,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:19] {2258} INFO - iteration 205, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:19] {2442} INFO -  at 3287.6s,    estimator xgb_limitdepth's best error=0.1755,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:19] {2258} INFO - iteration 206, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:19] {2442} INFO -  at 3287.9s,    estimator xgb_limitdepth's best error=0.1752,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:19] {2258} INFO - iteration 207, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:20] {2442} INFO -  at 3288.1s,    estimator xgb_limitdepth's best error=0.1752,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:20] {2258} INFO - iteration 208, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:23] {2442} INFO -  at 3291.5s,    estimator extra_tree's best error=0.1673,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:23] {2258} INFO - iteration 209, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:24] {2442} INFO -  at 3293.0s,    estimator xgb_limitdepth's best error=0.1752,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:24] {2258} INFO - iteration 210, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:32] {2442} INFO -  at 3300.2s,    estimator extra_tree's best error=0.1637,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:32] {2258} INFO - iteration 211, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:40] {2442} INFO -  at 3308.6s,    estimator extra_tree's best error=0.1630,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:40] {2258} INFO - iteration 212, current learner extra_tree
[flaml.automl.logger: 12-03 11:06:47] {2442} INFO -  at 3315.5s,    estimator extra_tree's best error=0.1630,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:47] {2258} INFO - iteration 213, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:47] {2442} INFO -  at 3315.9s,    estimator xgb_limitdepth's best error=0.1668,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:47] {2258} INFO - iteration 214, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:48] {2442} INFO -  at 3316.2s,    estimator xgb_limitdepth's best error=0.1668,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:48] {2258} INFO - iteration 215, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:49] {2442} INFO -  at 3317.8s,    estimator xgb_limitdepth's best error=0.1668,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:49] {2258} INFO - iteration 216, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:51] {2442} INFO -  at 3319.2s,    estimator xgb_limitdepth's best error=0.1585,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:51] {2258} INFO - iteration 217, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:51] {2442} INFO -  at 3319.9s,    estimator xgb_limitdepth's best error=0.1585,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:51] {2258} INFO - iteration 218, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:55] {2442} INFO -  at 3323.6s,    estimator xgb_limitdepth's best error=0.1585,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:55] {2258} INFO - iteration 219, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:06:56] {2442} INFO -  at 3324.4s,    estimator xgb_limitdepth's best error=0.1585,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:06:56] {2258} INFO - iteration 220, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:07:01] {2442} INFO -  at 3329.2s,    estimator xgb_limitdepth's best error=0.1528,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:07:01] {2258} INFO - iteration 221, current learner extra_tree
[flaml.automl.logger: 12-03 11:07:06] {2442} INFO -  at 3334.4s,    estimator extra_tree's best error=0.1630,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:07:06] {2258} INFO - iteration 222, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:07:11] {2442} INFO -  at 3339.9s,    estimator xgb_limitdepth's best error=0.1505,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:07:11] {2258} INFO - iteration 223, current learner lgbm
[flaml.automl.logger: 12-03 11:07:13] {2442} INFO -  at 3341.7s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:07:13] {2258} INFO - iteration 224, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:07:18] {2442} INFO -  at 3346.2s,    estimator xgb_limitdepth's best error=0.1505,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:07:18] {2258} INFO - iteration 225, current learner xgb_limitdepth
[flaml.automl.logger: 12-03 11:07:20] {2442} INFO -  at 3348.9s,    estimator xgb_limitdepth's best error=0.1505,   best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:07:20] {2258} INFO - iteration 226, current learner lgbm
[flaml.automl.logger: 12-03 11:11:36] {2442} INFO -  at 3604.8s,    estimator lgbm's best error=0.1300, best estimator lgbm's best error=0.1300
[flaml.automl.logger: 12-03 11:12:03] {2685} INFO - retrain lgbm for 26.3s
[flaml.automl.logger: 12-03 11:12:03] {2688} INFO - retrained model: LGBMClassifier(colsample_bytree=0.5411508919087042,
               learning_rate=0.19001318344547957, max_bin=1023,
               min_child_samples=4, n_estimators=143, n_jobs=-1, num_leaves=588,
               reg_alpha=0.029139600936312147, reg_lambda=0.05662388017689599,
               verbose=-1)
[flaml.automl.logger: 12-03 11:12:03] {1985} INFO - fit succeeded
[flaml.automl.logger: 12-03 11:12:03] {1986} INFO - Time taken to find the best model: 1805.8858296871185</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>time_history, best_valid_loss_history, valid_loss_history, config_history, metric_history <span class="op">=</span> get_output_from_log(filename<span class="op">=</span><span class="st">"purchased.log"</span>, time_budget<span class="op">=</span><span class="dv">7200</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Learning Curve"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time (s)"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Validation F1"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.step(time_history, <span class="dv">1</span> <span class="op">-</span> np.array(best_valid_loss_history), where<span class="op">=</span><span class="st">"post"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the index of the best validation loss</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>best_index <span class="op">=</span> np.argmin(best_valid_loss_history)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the best configuration from the config history</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>best_config <span class="op">=</span> config_history[best_index]</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>learner_name <span class="op">=</span> best_config[<span class="st">"Current Learner"</span>]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> best_config[<span class="st">"Current Hyper-parameters"</span>]</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print the best configuration as a dictionary</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best Configuration based on the best validation loss:"</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(best_config[<span class="st">"Current Learner"</span>])</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(best_config[<span class="st">"Current Hyper-parameters"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="%5BSTEP%203.3%5D%20Purchase%20prediction_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Configuration based on the best validation loss:
lgbm
{'n_estimators': 143, 'num_leaves': 588, 'min_child_samples': 4, 'learning_rate': 0.19001318344547957, 'log_max_bin': 10, 'colsample_bytree': 0.5411508919087042, 'reg_alpha': 0.029139600936312147, 'reg_lambda': 0.05662388017689599, 'FLAML_sample_size': 225347}</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    plt.barh(automl.model.estimator.feature_name_, automl.model.estimator.feature_importances_)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="%5BSTEP%203.3%5D%20Purchase%20prediction_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the most useful features</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(<span class="bu">sorted</span>(<span class="bu">zip</span>(automl.model.estimator.feature_importances_, X.columns), reverse<span class="op">=</span><span class="va">True</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----  ------------------------
20505  car_age_days
19325  average_visit_time
13142  loyalty
10164  visit_duration_time
 4889  price
 3655  visit_number
  779  platform_Dealership
  687  gender_Male
  675  gender_Female
  619  engaged
  611  email_domain_gmail.com
  608  email_domain_hotmail.com
  597  email_domain_outlook.com
  559  email_domain_yahoo.com
  515  discount
  478  platform_Website
  405  gender_Other
  343  car_model_Model iY
  303  platform_Mobile App
  282  fuel_type_Gasoline
  279  car_model_Coupe
  274  car_model_Sedan
  252  car_model_Touring
  234  car_model_Model iX
  231  car_model_Tourer
  226  fuel_type_Electric
  221  car_model_Model M
  220  car_model_Model i7
  214  car_model_1 Series
  207  car_model_3 Series
  173  car_model_Sierra
  148  car_model_Model i8
  145  fuel_type_Diesel
  113  reviewed
-----  ------------------------</code></pre>
</div>
</div>
<p>The analysis suggests that we can easily predict if a user is going to buy a car or not. The most important features influencing the prediction are:</p>
<ol type="1">
<li>Car Age (in days)</li>
<li>Average Visit Time</li>
<li>Loyalty</li>
<li>Visit Duration Time</li>
<li>Price</li>
<li>Visit Number</li>
<li>platform_Dealership</li>
</ol>
<p>From the feature importance analysis, it is evident that user behavior metrics such as average visit time, visit duration, and visit number play a significant role in predicting car purchases. Additionally, factors like car age, loyalty, price, and engagement also contribute to the prediction model. This insight can help in targeting potential buyers more effectively and improving marketing strategies.</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div id="cell-24" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> automl.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Truth'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="%5BSTEP%203.3%5D%20Purchase%20prediction_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># metrics</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> [</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Accuracy"</span>, accuracy],</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Precision"</span>, precision],</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Recall"</span>, recall],</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"F1 Score"</span>, f1]</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(metrics, headers<span class="op">=</span>[<span class="st">"Metric"</span>, <span class="st">"Value"</span>], tablefmt<span class="op">=</span><span class="st">"grid"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+-----------+----------+
| Metric    |    Value |
+===========+==========+
| Accuracy  | 0.936259 |
+-----------+----------+
| Precision | 0.879296 |
+-----------+----------+
| Recall    | 0.852223 |
+-----------+----------+
| F1 Score  | 0.865548 |
+-----------+----------+</code></pre>
</div>
</div>
<p>Just as reminder:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image/Precision%20vs%20accuracy.png" title="Just as reminder" class="img-fluid figure-img"></p>
<figcaption>Precision vs Accuracy</figcaption>
</figure>
</div>
<p>The metrics indicate that it is possible to predict whether a user will purchase a car with a reasonable level of accuracy.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>